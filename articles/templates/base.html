{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1">
    <title>News Application</title>

    <!-- Bootstrap CSS (v5) -->
    <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

    <!-- Your styles (after Bootstrap) -->
    <link rel="stylesheet" href="{% static 'articles/styles.css' %}">
    {% block extra_css %}{% endblock %}
  </head>
  <body>
    <!-- Navbar -->
    <nav class="na-navbar">
      <div class="na-nav-inner">
        <div style="display: flex; align-items: center;">
          <a class="na-brand" href="/">News Application</a>
          
          {% if user.is_authenticated and user.role == 'editor' %}
            <div style="margin-left: 1rem;">
              {% if twitter_status.is_connected %}
                <span class="badge bg-success" style="font-size: 0.8rem; padding: 0.4rem 0.6rem;">
                  âœ“ Twitter Connected
                </span>
                <a href="{% url 'twitter_disconnect' %}" class="btn btn-sm" style="margin-left: 0.5rem; background-color: #6c757d; color: white; border: none;">
                  Disconnect
                </a>
              {% elif twitter_status.has_credentials %}
                <a href="{% url 'twitter_connect' %}" class="btn btn-warning btn-sm">
                  Connect Twitter
                </a>
              {% else %}
                <span class="badge bg-secondary" style="font-size: 0.8rem;" title="Twitter credentials not configured">
                  Twitter Unavailable
                </span>
              {% endif %}
            </div>
          {% endif %}
        </div>

        <ul class="na-nav-links">
            {% if user.is_authenticated %}
              {% if user.role == 'reader' %}
                <li><a href="{% url 'subscriptions' %}">Subscriptions</a></li>
                <li><a href="{% url 'browse_all_news' %}">Browse All News</a></li>
              {% endif %}
              
              <li><a href="{% url 'newsfeed' %}">{% if user.role == 'reader' %}My Feed{% else %}Newsfeed{% endif %}</a></li>
          
              <li>
                <a href="{% url 'logout' %}" class="na-btn na-btn-secondary" onclick="event.preventDefault(); this.closest('li').querySelector('form').submit();">
                  Logout
                </a>
                <form method="post" action="{% url 'logout' %}" style="display: none;">
                  {% csrf_token %}
                </form>
              </li>
              
              <li>
                <a href="{% url 'user_profile' %}" class="na-btn na-btn-secondary na-profile-circle na-avatar-{{ user.role }}" title="Profile">
                  {{ user.username|first|upper }}
                </a>
              </li>
            {% else %}
              <li>
                <a class="na-btn na-btn-primary" href="{% url 'login' %}">Login</a>
              </li>
              <li>
                <a class="na-btn na-btn-secondary" href="{% url 'register' %}">
                  Register
                </a>
              </li>
            {% endif %}
          </ul>
          
      </div>
    </nav>

    <!-- Flash messages -->
    {% if messages %}
      <div class="na-messages">
        {% for message in messages %}
          <div class="na-alert na-{{ message.tags }}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Page content -->
    <main class="na-feed">
      {% block content %}{% endblock %}
    </main>

    {% block extra_js %}{% endblock %}
  </body>
</html>